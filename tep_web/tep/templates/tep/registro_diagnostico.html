{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}
    Diagnóstico de TEP
{% endblock %}

{% block content %}
  <div class="card col-lg-8 offset-lg-2">
    <div class="card-header">
      <h3 class="card-title"><b>Registro de datos Médicos</b></h3>
    </div>
    <!-- /.card-header -->
    <div class="card-body">
      <form method="post">
        {% csrf_token %}
        {{form|crispy}}
        <button type="submit" class="btn btn-primary">Diagnosticar</button>
      </form>
    </div>
    <!-- /.card-body -->
  </div>
  <!-- /.card -->
{% endblock %}

{% block nav_footer %}
<footer class="main-footer">
    <strong>Universidad del Valle 2020 <a href="http://www.univalle.edu.co">www.univalle.edu.co</a>.</strong>
      TEP Prediction
    <div class="float-right d-none d-sm-inline-block">
      <b>Version</b> 1.0.0
    </div>
  </footer>
{% endblock %}

{% block javascript %}
{{ block.super }}
<script>
    var consulta_anonima = "{{anonimo}}";
    anonimo = (consulta_anonima == 'True')    

    //console.log(anonimo);

    if(!anonimo){
      $('#div_id_genero').attr('hidden','');
      $('#div_id_edad').attr('hidden','');  
    }   

    $('#id_paciente').change(function(){      
      $.ajax({
            type: 'GET',
            dataType: 'json',
            url: '/tep/paciente/' +  $(this).children("option:selected").val(),
            success: function(data) {
              document.getElementById('id_genero').value = data['paciente']['sexo']
              $('#id_edad').attr('value', data['paciente']['edad']);  
            }
      });
    });
</script>
{% endblock %}
